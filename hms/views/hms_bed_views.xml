<!-- hms/views/hms_bed_views.xml -->
<odoo>

    <!-- list view -->
    <record id="view_hms_bed_tree" model="ir.ui.view">
        <field name="name">hms.bed.tree</field>
        <field name="model">hms.bed</field>
        <field name="arch" type="xml">
            <list>
                <field name="name"/>
                <field name="room_id"/>
                <field name="state"/>
            </list>
        </field>
    </record>

    <!-- Form view -->
    <record id="view_hms_bed_form" model="ir.ui.view">
        <field name="name">hms.bed.form</field>
        <field name="model">hms.bed</field>
        <field name="arch" type="xml">
            <form string="Bed">
                <sheet>
                <header>
                    <button name="action_oof_bed" type="object" string="Mark as Out of Service" class="btn-primary" invisible="state == 'maintenance'"/>
                    <button name="action_restore_bed" type="object" string="Restore Bed" class="btn-primary" invisible="state != 'maintenance'"/>
                </header>
                    <group>
                        <field name="name" readonly="1"/>
                        <field name="room_id" readonly="can_edit"/>
                        <field name="state" readonly="can_edit"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

        <!-- Professional search view for hms.bed -->
    <record id="view_hms_bed_search" model="ir.ui.view">
        <field name="name">hms.bed.search</field>
        <field name="model">hms.bed</field>
        <field name="arch" type="xml">
            <search string="Bed Search">
                <!-- Search fields for quick search -->
                <field name="name" string="Bed Number" filter_domain="[('name', 'ilike', self)]"/>
                <field name="room_id" string="Room" filter_domain="[('room_id.name', 'ilike', self)]"/>
                <field name="department_id" string="Department" filter_domain="[('department_id.name', 'ilike', self)]"/>
                <field name="display_name" string="Full Bed Identifier" filter_domain="['|', ('name', 'ilike', self), ('display_name', 'ilike', self)]"/>
                
                <!-- Predefined filters -->
                <filter string="Available Beds" name="available" domain="[('state', '=', 'available')]"/>
                <filter string="Occupied Beds" name="occupied" domain="[('state', '=', 'occupied')]"/>
                <filter string="Maintenance Beds" name="maintenance" domain="[('state', '=', 'maintenance')]"/>
                
                <separator/>
                
                <!-- Department-specific filters -->
                <filter string="Emergency Department Beds" name="emergency_beds" domain="[('department_id.name', 'ilike', 'Emergency')]"/>
                <filter string="ICU Beds" name="icu_beds" domain="[('department_id.name', 'ilike', 'ICU')]"/>
                <filter string="Surgery Department Beds" name="surgery_beds" domain="[('department_id.name', 'ilike', 'Surgery')]"/>
                <filter string="Maternity Department Beds" name="maternity_beds" domain="[('department_id.name', 'ilike', 'Maternity')]"/>
                
                <separator/>
                
                <!-- Special filters -->
                <filter string="Beds Without Room" name="no_room" domain="[('room_id', '=', False)]"/>
                <filter string="Beds Without Department" name="no_department" domain="[('department_id', '=', False)]"/>
                
                <!-- Group By section -->
                <group name="group_by">
                    <filter string="Status" name="group_by_state" context="{'group_by': 'state'}"/>
                    <filter string="Room" name="group_by_room" context="{'group_by': 'room_id'}"/>
                    <filter string="Department" name="group_by_department" context="{'group_by': 'department_id'}"/>
                    <filter string="Status by Department" name="group_by_state_department" context="{'group_by': 'state', 'group_by': 'department_id'}"/>
                    <filter string="Room by Department" name="group_by_room_department" context="{'group_by': 'room_id', 'group_by': 'department_id'}"/>
                </group>
                
                <!-- Search Panel for faceted search -->
                <searchpanel>
                    <field name="state" string="Status" icon="fa-bed" select="multi" enable_counters="1"/>
                    <field name="department_id" string="Department" icon="fa-building" select="multi" enable_counters="1"/>
                    <field name="room_id" string="Room" icon="fa-door-open" select="multi" enable_counters="1"/>
                </searchpanel>
            </search>
        </field>
    </record>

    <!-- Action -->
    <record id="action_hms_bed" model="ir.actions.act_window">
        <field name="name">Beds</field>
        <field name="res_model">hms.bed</field>
        <field name="view_mode">list,form</field>
    </record>

</odoo>
